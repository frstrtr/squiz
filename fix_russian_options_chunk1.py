#!/usr/bin/env python3
"""
Fix Russian option translations for questions 1-30 based on actual English content
"""
import json
import os
import tempfile

# Correct Russian option translations matching the actual English options
options_translations = {
    1: {
        "A": "управление прогулочным судном без второго человека на борту для несения вахты",
        "B": "управление прогулочным судном, не оборудованным навигационными огнями, в лунную ночь",
        "C": "управление прогулочным судном на скорости 27 узлов в открытом море, когда другие суда не видны",
        "D": "управление прогулочным судном на расстоянии 21,5 морских миль от берега Флик-ан-Флак, имея лицензию категории"
    },
    2: {
        "A": "345 C",
        "B": "185 C",
        "C": "350 C",
        "D": "165 C"
    },
    3: {
        "A": "затопленная часть на плаву",
        "B": "самая нижняя секция внутри судна, ближайшая к килю",
        "C": "вертикальная высота между ватерлинией и килем",
        "D": "ширина открытой палубы"
    },
    4: {
        "A": "12 морских миль",
        "B": "16 морских миль",
        "C": "20 морских миль",
        "D": "24 морских мили"
    },
    5: {
        "A": "По красным и черным полосам",
        "B": "По его положению на скалах",
        "C": "По серии из шести коротких вспышек красного света",
        "D": "По серии из двух вспышек белого света"
    },
    6: {
        "A": "лечь на курс 205°",
        "B": "оставаться на том же курсе и пройти примерно в 100 м справа от этого буя",
        "C": "повернуть влево не более чем на 15 градусов",
        "D": "держаться подальше, так как это буй изолированной опасности"
    },
    7: {
        "A": "когда шкипер один на борту судна в море, обязанность вести наблюдение лежит на шкипере",
        "B": "шкипер не освобождается от обязанности вести наблюдение ночью, даже если видимость отличная",
        "C": "шкипер должен обеспечить, чтобы наблюдение велось постоянно днем и ночью",
        "D": "шкипер может прекратить визуальное наблюдение при ограниченной видимости, если работает радар"
    },
    8: {
        "A": "его возраст и опыт",
        "B": "количество людей, назначенных для несения вахты",
        "C": "длина судна",
        "D": "плотность движения судов в данный момент"
    },
    9: {
        "A": "оставить этот буй слева в начале канала",
        "B": "вызвать портовые власти на канале 16 для получения инструкций",
        "C": "оставить этот буй справа в начале канала",
        "D": "остановить двигатели и дать задний ход"
    },
    10: {
        "A": "судно P должно изменить курс влево, чтобы избежать столкновения",
        "B": "судно P может поддерживать курс и скорость",
        "C": "судно Q должно было изменить курс влево гораздо раньше",
        "D": "судно Q должно было изменить курс вправо гораздо раньше"
    },
    11: {
        "A": "нанести позицию GPS на карту",
        "B": "вызвать все суда на канале 16 и запросить их позиции GPS",
        "C": "включить навигационные огни",
        "D": "включить радар"
    },
    12: {
        "A": "поддерживать курс и скорость",
        "B": "лечь на курс 350",
        "C": "держаться от нее подальше",
        "D": "вызвать ее на канале 16, чтобы узнать ее намерения"
    },
    13: {
        "A": "она не может отклониться от курса из-за большой осадки",
        "B": "она на мели",
        "C": "она не может маневрировать, чтобы избежать столкновения, из-за работы, которую выполняет",
        "D": "она не может маневрировать, чтобы избежать столкновения, из-за технической проблемы"
    },
    14: {
        "A": "подать один продолжительный сигнал",
        "B": "подать не менее пяти коротких и частых сигналов",
        "C": "подать три коротких сигнала",
        "D": "подать один короткий сигнал"
    },
    15: {
        "A": "Северный",
        "B": "Восточный",
        "C": "Северо-западный",
        "D": "Юго-восточный"
    },
    16: {
        "A": "ветер дует против часовой стрелки вокруг центра области низкого давления в Южном полушарии",
        "B": "атмосферное давление постепенно увеличивается при удалении от центра области низкого давления",
        "C": "области низкого давления характеризуются неустойчивыми погодными условиями",
        "D": "непрерывное нагревание большой массы морской воды приводит к образованию областей низкого давления"
    },
    17: {
        "A": "повернуть влево на 15 градусов и увеличить скорость, чтобы пройти впереди судна B",
        "B": "снизить скорость и повернуть вправо не менее чем на 60 градусов",
        "C": "остановиться и включить двигатели на задний ход",
        "D": "остановиться и сделать радиовызов для выяснения намерений судна B"
    },
    18: {
        "A": "Вы должны изменить курс вправо, чтобы вернуться на маршрут",
        "B": "Ваше судно находится правее маршрута",
        "C": "Ваше судно находится левее маршрута",
        "D": "Ваше судно испытывает небольшой дрейф влево"
    },
    19: {
        "A": "случай неминуемой угрозы жизни",
        "B": "случай, когда безопасность плавания может быть под угрозой",
        "C": "случай судна, выведенного из строя отказом двигателя",
        "D": "случай судна, перевозящего опасный груз"
    },
    20: {
        "A": "изменить курс вправо, приказать бросить спасательный круг, выставить наблюдателя",
        "B": "изменить курс влево, вызвать НБО на канале 16, выполнить поворот Уильямсона",
        "C": "изменить курс влево, приказать бросить спасательный круг, выставить наблюдателя",
        "D": "изменить курс вправо, нажать кнопку MOB на GPS, выставить наблюдателя"
    },
    21: {
        "A": "два черных шара один над другим",
        "B": "черный бикон",
        "C": "черная коническая форма с вершиной, направленной вниз",
        "D": "черный шар"
    },
    22: {
        "A": "изменить курс вправо и держаться на безопасном расстоянии от парусного судна",
        "B": "поддерживать курс и скорость",
        "C": "изменить курс влево и держаться на безопасном расстоянии от парусного судна",
        "D": "ждать, пока парусное судно маневрирует первым"
    },
    23: {
        "A": "правый борт",
        "B": "наветренная сторона",
        "C": "левый борт",
        "D": "подветренная сторона"
    },
    24: {
        "A": "Национальная береговая охрана",
        "B": "владелец судна",
        "C": "Управление по туризму",
        "D": "шкипер судна"
    },
    25: {
        "A": "вы можете использовать канал 16 для связи с другим судном",
        "B": "вы можете передать сообщение о бедствии на канале 16",
        "C": "вы не можете передавать на канале 16 при плавании внутри порта",
        "D": "вы не можете делать длительные передачи на канале 16"
    },
    26: {
        "A": "канал 8",
        "B": "канал 78",
        "C": "канал 16",
        "D": "канал 74"
    },
    27: {
        "A": "танкер на мели",
        "B": "танкер на якоре",
        "C": "танкер не может маневрировать согласно правилам из-за исключительных обстоятельств",
        "D": "танкер требует помощи"
    },
    28: {
        "A": "включить радар",
        "B": "снизить скорость",
        "C": "вызвать на канале 16 для запроса позиций GPS судов в районе",
        "D": "сделать отметку на карте"
    },
    29: {
        "A": "океанское течение",
        "B": "ветер",
        "C": "прилив",
        "D": "антициклон"
    },
    30: {
        "A": "температура воды",
        "B": "атмосферное давление",
        "C": "глубина",
        "D": "соленость"
    }
}

def apply_options_translations():
    """Apply correct Russian option translations to questions 1-30"""
    
    with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
        quiz_data = json.load(f)
    
    count = 0
    for question in quiz_data:
        q_id = question['id']
        if q_id in options_translations:
            question['translations']['ru']['options'] = options_translations[q_id]
            count += 1
    
    # Write atomically
    temp_fd, temp_path = tempfile.mkstemp(suffix='.json', text=True)
    try:
        with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
            json.dump(quiz_data, f, ensure_ascii=False, indent=2)
        os.replace(temp_path, 'quiz-data-final.json')
        print(f"✓ Fixed Russian option translations for questions 1-30 ({count} questions)")
    except Exception as e:
        os.unlink(temp_path)
        raise e

if __name__ == "__main__":
    apply_options_translations()
