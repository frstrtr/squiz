#!/usr/bin/env python3
"""
Fix Russian option translations for questions 61-90 based on actual English content
"""
import json
import os
import tempfile

options_translations = {
    61: {
        "A": "будет видна с вашей левой стороны",
        "B": "не будет видна",
        "C": "будет видна с вашей правой стороны",
        "D": "будет видна, но зеленого цвета"
    },
    62: {
        "A": "к западу от маяка Ило Бенуа",
        "B": "на пеленге 022° И от маяка Ило Бенуа",
        "C": "к юго-западу от маяка Ило Бенуа",
        "D": "к востоку от маяка Ило Бенуа"
    },
    63: {
        "A": "6 узлов",
        "B": "12 узлов",
        "C": "18 узлов",
        "D": "24 узла"
    },
    64: {
        "A": "в южном полушарии",
        "B": "на широте, которая составляет 23,123 морских мили к югу от экватора",
        "C": "в северном полушарии и к востоку от Гринвичского меридиана",
        "D": "на долготе, которая находится к западу от Гринвичского меридиана под углом 14,701 минуты"
    },
    65: {
        "A": "снизить скорость и изменить курс на 200° C",
        "B": "увеличить скорость до 16 узлов и пройти не менее 50 метров с подветренной стороны",
        "C": "снизить скорость и изменить курс на 320° C",
        "D": "снизить скорость и пройти достаточно близко к бую, но с подветренной стороны"
    },
    66: {
        "A": "Его не видно в открытом море",
        "B": "У него есть топовая марка, окрашенная в черный цвет",
        "C": "Это один из двух латеральных буев",
        "D": "Его следует оставлять слева при выходе из гавани в открытое море"
    },
    67: {
        "A": "только один ПРИЛИВ за 24 часа",
        "B": "более высокие ОТЛИВЫ и более низкие ПРИЛИВЫ",
        "C": "более высокие ПРИЛИВЫ и более низкие ОТЛИВЫ",
        "D": "слабые приливные течения на входе и выходе из проходов"
    },
    68: {
        "A": "обеспечение того, что судно следует правильным курсом",
        "B": "консультирование вахтенного офицера о том, когда изменить курс для предотвращения столкновения",
        "C": "сообщение о присутствии других судов или опасностей, чтобы вахтенный офицер мог оценить риск",
        "D": "сообщение об изменениях погодных условий"
    },
    69: {
        "A": "судно B пройдет впереди судна A без риска столкновения",
        "B": "судно B должно подать два коротких сигнала и изменить курс влево, чтобы пройти за кормой судна A",
        "C": "существует высокий риск столкновения",
        "D": "судно A может поддерживать курс и скорость"
    },
    70: {
        "A": "подать один короткий сигнал и изменить курс вправо не менее чем на 60 градусов",
        "B": "подать два коротких сигнала и изменить курс влево не менее чем на 60 градусов",
        "C": "подать три коротких сигнала и включить задний ход",
        "D": "подать не менее пяти коротких и частых сигналов и отдать якорь"
    },
    71: {
        "A": "судно с парасейлингом имеет право дороги",
        "B": "ваше судно должно держаться своего курса",
        "C": "вам нужно подать два коротких сигнала и изменить курс влево",
        "D": "судно с парасейлингом ограничено в возможности маневрировать"
    },
    72: {
        "A": "вы должны подать три коротких сигнала и изменить курс влево",
        "B": "вы обгоняемое судно",
        "C": "вы должны предпринять действия для предотвращения столкновения",
        "D": "вы не можете изменить курс вправо"
    },
    73: {
        "A": "подать три коротких сигнала и включить задний ход",
        "B": "подать два коротких сигнала и сделать резкое изменение курса вправо, чтобы держаться подальше от нее",
        "C": "подать два коротких сигнала и сделать резкое изменение курса влево, чтобы держаться подальше от нее",
        "D": "увеличить скорость и пройти впереди нее"
    },
    74: {
        "A": "изменить курс влево не менее чем на 60 градусов, чтобы пройти за ее кормой",
        "B": "изменить курс влево или вправо, потому что она на мели",
        "C": "изменить курс вправо не менее чем на 60 градусов, так как она на якоре и занята какой-то работой",
        "D": "остановить двигатели и включить задний ход"
    },
    75: {
        "A": "на якоре",
        "B": "на мели",
        "C": "ограничено в возможности маневрировать",
        "D": "стеснено своей осадкой"
    },
    76: {
        "A": "15 градусов",
        "B": "30 градусов",
        "C": "45 градусов",
        "D": "60 градусов"
    },
    77: {
        "A": "ваше судно левее маршрута",
        "B": "вы должны идти курсом выше 032° C, чтобы вернуться на маршрут",
        "C": "вы должны идти курсом ниже 032° C, чтобы вернуться на маршрут",
        "D": "вы должны развернуться и начать подход заново"
    },
    78: {
        "A": "вы должны изменить курс влево не менее чем на 60 градусов",
        "B": "контейнеровоз пройдет впереди вас",
        "C": "существует высокий риск столкновения",
        "D": "вы должны поддерживать курс и скорость"
    },
    79: {
        "A": "уверить пассажиров, что на борту есть спасательные жилеты",
        "B": "посоветовать пассажирам не выходить на открытую палубу без спасательного жилета",
        "C": "проинформировать всех пассажиров, что всегда существует определенная степень риска в море",
        "D": "гарантировать всем пассажирам, что выход пройдет без происшествий, основываясь на его многолетнем опыте"
    },
    80: {
        "A": "GPS",
        "B": "Компас",
        "C": "Радар",
        "D": "УКВ радио"
    },
    81: {
        "A": "Компас",
        "B": "Руль",
        "C": "Узел",
        "D": "Течение"
    },
    82: {
        "A": "Океанское течение",
        "B": "Прилив",
        "C": "Цунами",
        "D": "Антициклон"
    },
    83: {
        "A": "к северу от маяка",
        "B": "к западу от маяка",
        "C": "к юго-востоку от маяка",
        "D": "к северо-западу от маяка"
    },
    84: {
        "A": "находится в северном полушарии и к востоку от Гринвичского меридиана",
        "B": "находится в южном полушарии и к востоку от Гринвичского меридиана",
        "C": "находится в южном полушарии и к западу от Гринвичского меридиана",
        "D": "находится на широте 19 градусов 53,823 минуты к северу от экватора"
    },
    85: {
        "A": "сделать большое изменение курса влево",
        "B": "сделать большое изменение курса вправо",
        "C": "остановиться и дать задний ход",
        "D": "вызвать станцию береговой охраны для подтверждения маневра"
    },
    86: {
        "A": "при движении в канале",
        "B": "когда существует опасная ситуация, требующая другого маневра для безопасности лодки и пассажиров",
        "C": "когда он должен вовремя прибыть к месту назначения",
        "D": "когда видимость снижена"
    },
    87: {
        "A": "использовать бинокль для осмотра островов и побережья",
        "B": "следить за УКВ радио каналом 16 для получения сводки погоды",
        "C": "вести радарное наблюдение только вечером",
        "D": "использовать все доступные средства на борту для проверки риска столкновения"
    },
    88: {
        "A": "максимальная рекомендуемая скорость в зависимости от мощности двигателя",
        "B": "скорость менее 10 узлов",
        "C": "скорость, которая позволяет шкиперу принять соответствующие и эффективные меры для предотвращения столкновения",
        "D": "максимальная скорость, рекомендованная производителем лодки"
    },
    89: {
        "A": "опыт шкипера",
        "B": "возраст шкипера",
        "C": "видимость",
        "D": "мощность двигателя"
    },
    90: {
        "A": "резко повернуть влево, учитывая, что лодка X должна сделать тот же маневр",
        "B": "резко повернуть вправо, учитывая, что лодка X должна сделать тот же маневр",
        "C": "поддерживать курс и скорость",
        "D": "импровизировать наилучший маневр для предотвращения столкновения, сохраняя безопасность лодки"
    }
}

def apply_options_translations():
    """Apply correct Russian option translations to questions 61-90"""
    
    with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
        quiz_data = json.load(f)
    
    count = 0
    for question in quiz_data:
        q_id = question['id']
        if q_id in options_translations:
            question['translations']['ru']['options'] = options_translations[q_id]
            count += 1
    
    # Write atomically
    temp_fd, temp_path = tempfile.mkstemp(suffix='.json', text=True)
    try:
        with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
            json.dump(quiz_data, f, ensure_ascii=False, indent=2)
        os.replace(temp_path, 'quiz-data-final.json')
        print(f"✓ Fixed Russian option translations for questions 61-90 ({count} questions)")
    except Exception as e:
        os.unlink(temp_path)
        raise e

if __name__ == "__main__":
    apply_options_translations()
