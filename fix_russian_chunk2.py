#!/usr/bin/env python3
"""
Fix Russian translations for questions 31-60 based on actual English content
"""
import json
import os
import tempfile

# Correct Russian translations matching the actual English questions
translations = {
    31: {
        "question": "Вы получаете радиовызов на канале 16, начинающийся словами 'MAYDAY MAYDAY MAYDAY'. Что это означает?",
        "options": {
            "A": "это срочное медицинское сообщение",
            "B": "это предупреждение о безопасности навигации",
            "C": "судно или люди находятся в серьезной и непосредственной опасности",
            "D": "это запрос информации о погоде"
        }
    },
    32: {
        "question": "Ваш вахтенный указывает на другое судно дальше в открытом море, показывающее огни, которые вы оба интерпретируете как красный-белый-красный, расположенные вертикально. Это судно",
        "options": {
            "A": "лишено возможности управляться",
            "B": "занято рыболовством",
            "C": "ограничено в маневренности",
            "D": "на якоре"
        }
    },
    33: {
        "question": "Каковы три элемента, составляющие пожарный треугольник?",
        "options": {
            "A": "кислород, тепло и топливо",
            "B": "азот, тепло и топливо",
            "C": "кислород, вода и топливо",
            "D": "углекислый газ, тепло и топливо"
        }
    },
    34: {
        "question": "Где вы должны обычно находиться перед использованием огнетушителя для тушения пожара на борту судна?",
        "options": {
            "A": "с подветренной стороны от огня",
            "B": "с наветренной стороны от огня",
            "C": "прямо над огнем",
            "D": "под огнем"
        }
    },
    35: {
        "question": "Одна из мер предосторожности перед запуском подвесного двигателя - это",
        "options": {
            "A": "убедиться, что нейтраль включена",
            "B": "открыть дроссель полностью",
            "C": "снять воздушный фильтр",
            "D": "отключить систему охлаждения"
        }
    },
    36: {
        "question": "Согласно Закону об Управлении по туризму 2006 года, случай столкновения в море с участием прогулочного судна, повлекший травму или материальный ущерб, должен быть сообщен в Управление по туризму в течение",
        "options": {
            "A": "6 часов",
            "B": "12 часов",
            "C": "24 часов",
            "D": "48 часов"
        }
    },
    37: {
        "question": "Какое из следующих действий НЕ является правонарушением согласно Закону об Управлении по туризму 2006 года?",
        "options": {
            "A": "управление прогулочным судном в состоянии алкогольного опьянения",
            "B": "превышение максимальной вместимости судна",
            "C": "управление прогулочным судном со скоростью 8 узлов в пределах 300 метров от берега",
            "D": "управление прогулочным судном без действующей лицензии"
        }
    },
    38: {
        "question": "При каких из этих обстоятельств шкипер будет прав в своем решении НЕ оказывать помощь?",
        "options": {
            "A": "когда это создаст серьезную опасность для его судна или людей на борту",
            "B": "когда судну в беде уже оказывается помощь другим судном",
            "C": "когда люди в беде отказываются от помощи",
            "D": "во всех вышеперечисленных обстоятельствах"
        }
    },
    39: {
        "question": "Что означает 'ведение вахты в море'?",
        "options": {
            "A": "наблюдение только с помощью радара",
            "B": "наблюдение только визуально",
            "C": "наблюдение только на слух",
            "D": "использование всех доступных средств для наблюдения за окружающей обстановкой"
        }
    },
    40: {
        "question": "Какой из следующих углов подхода рекомендуется при швартовке к причалу в безветренную погоду?",
        "options": {
            "A": "90 градусов к причалу",
            "B": "параллельно причалу",
            "C": "под небольшим углом 20-30 градусов к причалу",
            "D": "под углом 45 градусов к причалу"
        }
    },
    41: {
        "question": "Какое из этих наблюдений в море подтверждает вне всякого сомнения, что ваше судно находится на курсе столкновения с другим судном?",
        "options": {
            "A": "пеленг на другое судно не изменяется",
            "B": "расстояние до другого судна уменьшается",
            "C": "другое судно показывает красный огонь",
            "D": "другое судно показывает зеленый огонь"
        }
    },
    42: {
        "question": "Шкиперы коммерческих прогулочных судов имеют юридическое обязательство проводить",
        "options": {
            "A": "еженедельную проверку безопасности",
            "B": "ежемесячную проверку безопасности",
            "C": "проверку безопасности перед каждой поездкой",
            "D": "ежегодную проверку безопасности"
        }
    },
    43: {
        "question": "Представьте, что вы управляете полностью оборудованным прогулочным судном с механическим двигателем длиной 12 метров в прибрежных водах ночью. Какие навигационные огни должно показывать ваше судно?",
        "options": {
            "A": "только белый круговой огонь",
            "B": "красный огонь слева, зеленый огонь справа и белый кормовой огонь",
            "C": "красный огонь слева, зеленый огонь справа, белый топовый огонь и белый кормовой огонь",
            "D": "только красный и зеленый бортовые огни"
        }
    },
    44: {
        "question": "Представьте, что вы управляете 12-метровым судном с механическим двигателем в море днем. Какой звуковой сигнал вы должны подать при встрече лоб в лоб с другим судном с механическим двигателем?",
        "options": {
            "A": "один короткий звуковой сигнал",
            "B": "два коротких звуковых сигнала",
            "C": "три коротких звуковых сигнала",
            "D": "один длинный звуковой сигнал"
        }
    },
    45: {
        "question": "Как 60-метровая моторная прогулочная лодка на якоре в прибрежных водах будет показывать свой статус ночью?",
        "options": {
            "A": "одним белым круговым огнем на носу",
            "B": "белым круговым огнем на носу и белым круговым огнем на корме",
            "C": "только кормовым огнем",
            "D": "красным круговым огнем"
        }
    },
    46: {
        "question": "В ситуации 'Человек за бортом', какая из этих последовательностей является наиболее подходящей?",
        "options": {
            "A": "бросить спасательный круг, кричать 'человек за бортом', не терять из виду человека, маневрировать для спасения",
            "B": "кричать 'человек за бортом', остановить двигатель, прыгнуть в воду",
            "C": "немедленно развернуть судно, не информируя других",
            "D": "продолжать движение и вызвать береговую охрану"
        }
    },
    47: {
        "question": "Прогулочное судно имеет регистрационный номер PC 1898 OL 12. Какое из следующих утверждений НЕВЕРНО?",
        "options": {
            "A": "PC означает прогулочное судно",
            "B": "1898 - регистрационный номер",
            "C": "OL означает подвесной двигатель",
            "D": "12 означает длину 12 метров"
        }
    },
    48: {
        "question": "Что такое 'осадка' лодки?",
        "options": {
            "A": "ширина лодки",
            "B": "длина лодки",
            "C": "вертикальное расстояние между ватерлинией и нижней частью киля",
            "D": "высота лодки над водой"
        }
    },
    49: {
        "question": "Какое расстояние преодолевается за 20 минут лодкой, идущей со скоростью 18 узлов?",
        "options": {
            "A": "6 морских миль",
            "B": "9 морских миль",
            "C": "12 морских миль",
            "D": "18 морских миль"
        }
    },
    50: {
        "question": "Вы шкипер судна с механическим двигателем в море. Судно Z с механическим двигателем находится прямо впереди вас, идя прямо на вас, и существует риск столкновения. Что должно сделать ваше судно согласно МППСС?",
        "options": {
            "A": "изменить курс влево и пройти правым бортом к правому борту судна Z",
            "B": "изменить курс вправо и пройти левым бортом к левому борту судна Z",
            "C": "изменить курс вправо и пройти правым бортом к правому борту судна Z",
            "D": "остановиться и ждать"
        }
    },
    51: {
        "question": "Как вы описали бы кормовой огонь, который является частью навигационных огней судна?",
        "options": {
            "A": "белый огонь, видимый на 135 градусов",
            "B": "белый огонь, видимый на 225 градусов",
            "C": "красный огонь, видимый на 112,5 градусов",
            "D": "зеленый огонь, видимый на 112,5 градусов"
        }
    },
    52: {
        "question": "Шкиперы прогулочных судов для коммерческой деятельности имеют юридическую обязанность уведомлять Управление по туризму о",
        "options": {
            "A": "любом изменении адреса владельца",
            "B": "любом изменении в двигателе судна",
            "C": "любом столкновении с травмой или материальным ущербом",
            "D": "всем вышеперечисленном"
        }
    },
    53: {
        "question": "Вы шкипер этой лодки, оборудованной двумя подвесными двигателями по 115 л.с. Эта лодка показывает, что она",
        "options": {
            "A": "на якоре",
            "B": "на мели",
            "C": "занята рыболовством",
            "D": "на ходу с механическим двигателем"
        }
    },
    54: {
        "question": "Каков рекомендуемый угол подхода для швартовки лодки?",
        "options": {
            "A": "90 градусов",
            "B": "45 градусов",
            "C": "20-30 градусов",
            "D": "параллельно причалу"
        }
    },
    55: {
        "question": "Как мы называем способность лодки вернуться в вертикальное положение после крена?",
        "options": {
            "A": "плавучесть",
            "B": "остойчивость",
            "C": "водоизмещение",
            "D": "осадка"
        }
    },
    56: {
        "question": "Какова ваша главная обязанность как шкипера?",
        "options": {
            "A": "обеспечить, чтобы все хорошо провели время",
            "B": "обеспечить безопасность всех на борту",
            "C": "достичь пункта назначения как можно быстрее",
            "D": "экономить топливо"
        }
    },
    57: {
        "question": "Какие два цвета используются для обозначения боковых знаков (буев)?",
        "options": {
            "A": "красный и белый",
            "B": "зеленый и белый",
            "C": "красный и зеленый",
            "D": "желтый и черный"
        }
    },
    58: {
        "question": "Боковые знаки используются для",
        "options": {
            "A": "обозначения безопасных вод",
            "B": "обозначения левой и правой сторон канала",
            "C": "обозначения изолированной опасности",
            "D": "обозначения специальной зоны"
        }
    },
    59: {
        "question": "Вы шкипер и также владелец лицензии коммерческого прогулочного судна PC 2001 OL 14. Управление по туризму может отозвать вашу лицензию, если вы",
        "options": {
            "A": "были осуждены за правонарушение",
            "B": "нарушили условия лицензии",
            "C": "признаны непригодным для управления прогулочным судном",
            "D": "все вышеперечисленное"
        }
    },
    60: {
        "question": "Какое из следующих действий лицензированного шкипера НЕ является правонарушением согласно Закону об Управлении по туризму?",
        "options": {
            "A": "превышение безопасной скорости в лагуне",
            "B": "управление судном с действующей лицензией",
            "C": "управление судном без надлежащего оборудования безопасности",
            "D": "управление судном в состоянии опьянения"
        }
    }
}

def apply_translations():
    """Apply correct Russian translations to questions 31-60"""
    
    with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
        quiz_data = json.load(f)
    
    count = 0
    for question in quiz_data:
        q_id = question['id']
        if q_id in translations:
            question['translations']['ru'] = translations[q_id]
            count += 1
    
    # Write atomically
    temp_fd, temp_path = tempfile.mkstemp(suffix='.json', text=True)
    try:
        with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
            json.dump(quiz_data, f, ensure_ascii=False, indent=2)
        os.replace(temp_path, 'quiz-data-final.json')
        print(f"✓ Fixed Russian translations for questions 31-60 ({count} questions)")
    except Exception as e:
        os.unlink(temp_path)
        raise e

if __name__ == "__main__":
    apply_translations()
