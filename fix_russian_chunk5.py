#!/usr/bin/env python3
"""
Fix Russian translations for questions 121-145 (final chunk) based on actual English content
"""
import json
import os
import tempfile

# Correct Russian translations matching the actual English questions
translations = {
    121: {
        "question": "Как вы классифицируете судно, которое по характеру своей работы не может уступить дорогу другому судну?",
        "options": {
            "A": "судно, ограниченное в возможности маневрировать",
            "B": "судно, стесненное своей осадкой",
            "C": "судно, лишенное возможности управляться",
            "D": "судно на мели"
        }
    },
    122: {
        "question": "Что бы вы сделали, если бы вы были шкипером судна с механическим двигателем, которое должно уступить дорогу парусному судну?",
        "options": {
            "A": "поддерживать курс, но увеличить скорость",
            "B": "поддерживать курс и скорость",
            "C": "изменить курс влево или вправо в зависимости от обстоятельств",
            "D": "остановить двигатель"
        }
    },
    123: {
        "question": "Какие офицеры уполномочены законом проверять судовые документы?",
        "options": {
            "A": "Инспектор рыболовства",
            "B": "Уполномоченный сотрудник Управления по туризму только",
            "C": "Полицейский, офицер Национальной береговой охраны и уполномоченный сотрудник Управления по туризму",
            "D": "Только офицер Национальной береговой охраны"
        }
    },
    124: {
        "question": "При каких обстоятельствах член Национальной береговой охраны может запретить выход прогулочного судна?",
        "options": {
            "A": "Когда прогулочное судно собирается покинуть лагуну",
            "B": "Когда видимость снижена",
            "C": "Когда, по их мнению, предполагаемый рейс является опасным",
            "D": "Когда прогулочное судно не оборудовано навигационными огнями"
        }
    },
    125: {
        "question": "На каком УКВ радио канале вы передадите сообщение о бедствии?",
        "options": {
            "A": "Канал 16",
            "B": "Канал 12",
            "C": "Канал 18",
            "D": "Канал 69"
        }
    },
    126: {
        "question": "Какое из этих судов показывает два вертикальных круговых огня, верхний красный и нижний белый?",
        "options": {
            "A": "парусное судно",
            "B": "буксируемое судно",
            "C": "рыболовное судно",
            "D": "судно, лишенное возможности управляться"
        }
    },
    127: {
        "question": "Что вы ожидаете от вашего помощника в роли впередсмотрящего?",
        "options": {
            "A": "Что он обеспечит комфорт всех пассажиров",
            "B": "Что он поможет вам правильно оценить ситуацию, предупреждая о других судах",
            "C": "Что он проверит, что лодка движется в правильном направлении",
            "D": "Что он будет напоминать вам время по своим часам"
        }
    },
    128: {
        "question": "Прямо перед вами на расстоянии примерно 200 метров вы замечаете парусное судно, показывающее черный конус вершиной вниз. Это означает, что",
        "options": {
            "A": "парусное судно нуждается в помощи",
            "B": "парусное судно также использует двигатель для движения",
            "C": "парусное судно занято рыболовством",
            "D": "парусное судно оборудовано двигателем, но не использует его"
        }
    },
    129: {
        "question": "В этой ситуации, согласно Международным правилам предупреждения столкновений судов в море (МППСС), вы должны",
        "options": {
            "A": "изменить курс вправо и держаться на безопасном расстоянии",
            "B": "поддерживать курс и скорость",
            "C": "изменить курс влево и держаться на безопасном расстоянии",
            "D": "ждать, пока парусное судно маневрирует первым"
        }
    },
    130: {
        "question": "Сейчас 10:45, и вы понимаете, что согласно GPS ваша лодка преодолела расстояние 5 морских миль за последние 30 минут. Скорость вашей лодки составляет",
        "options": {
            "A": "5 узлов",
            "B": "2,5 узла",
            "C": "10 узлов",
            "D": "12,5 узлов"
        }
    },
    131: {
        "question": "Начинается сильный дождь, и видимость резко снижается. В такой ситуации вы должны",
        "options": {
            "A": "снизить скорость и изменить курс влево",
            "B": "снизить скорость, включить навигационные огни и продолжить движение с осторожностью",
            "C": "поддерживать курс и скорость",
            "D": "увеличить скорость, но поддерживать курс"
        }
    },
    132: {
        "question": "Ваш помощник сообщает о судне, замеченном слегка с левого борта впереди, показывающем флаг 'Альфа'. Этот флаг означает, что судно",
        "options": {
            "A": "срочно нуждается в помощи",
            "B": "занято водолазными работами",
            "C": "дрейфует",
            "D": "произошел несчастный случай с водолазом"
        }
    },
    133: {
        "question": "В этой ситуации вы должны",
        "options": {
            "A": "снизить скорость и изменить курс, держась на расстоянии не менее 100 метров",
            "B": "снизить скорость и изменить курс, держась на расстоянии не менее 200 метров",
            "C": "снизить скорость и поддерживать курс",
            "D": "подойти к судну для оказания помощи"
        }
    },
    134: {
        "question": "Вы находитесь у Бэ дю Томбо и видите кардинальный буй прямо перед собой с топовым знаком, показывающим два черных конуса вершинами вверх. Согласно буйкам системы МАМС, вы",
        "options": {
            "A": "должны оставить этот буй по правому борту",
            "B": "должны оставить этот буй по левому борту",
            "C": "можете оставить этот буй как по левому, так и по правому борту",
            "D": "можете пройти очень близко к бую, потому что там достаточно воды"
        }
    },
    135: {
        "question": "Ваше прогулочное судно находится примерно в 2 морских милях от Порт-Луи и направляется в гавань Порт-Луи. Вы замечаете впереди два вертикальных огня (красный над красным). Согласно буйкам системы МАМС, эти огни обозначают",
        "options": {
            "A": "набор из двух знаков безопасной воды",
            "B": "боковые знаки",
            "C": "набор из двух специальных знаков",
            "D": "набор из двух красных знаков"
        }
    },
    136: {
        "question": "На каком УКВ радио канале следует вызвать диспетчерскую службу порта Порт-Луи?",
        "options": {
            "A": "канал 12 или 16",
            "B": "канал 61",
            "C": "канал 18",
            "D": "канал 69"
        }
    },
    137: {
        "question": "Вы находитесь в канале, и внезапно на расстоянии около 100 метров по правому носу вы замечаете зеленый круговой огонь на небольшом судне. Вы должны",
        "options": {
            "A": "снизить скорость и сделать большой поворот вправо",
            "B": "снизить скорость и сделать большой поворот влево",
            "C": "поддерживать курс и скорость",
            "D": "поддерживать курс и увеличить скорость, чтобы быстро пройти"
        }
    },
    138: {
        "question": "Вы находитесь в открытом море и видите большой танкер, показывающий эти вертикальные огни. Это означает, что",
        "options": {
            "A": "танкер на мели",
            "B": "танкер на якоре",
            "C": "танкер не может маневрировать согласно правилам из-за своей осадки",
            "D": "танкер требует помощи"
        }
    },
    139: {
        "question": "В открытом море человек на борту пироги внутри лагуны делает сигналы обеими руками, поднятыми вертикально. Это означает, что",
        "options": {
            "A": "он приветствует туристов на вашей лодке",
            "B": "он нуждается в помощи",
            "C": "он указывает, что ваша лодка направляется к опасности",
            "D": "он указывает, что вы должны изменить курс"
        }
    },
    140: {
        "question": "Вы замечаете с левого борта судно, показывающее следующие огни. Этот комплект огней означает, что судно",
        "options": {
            "A": "не может уступить дорогу другому судну из-за своей работы",
            "B": "не может уступить дорогу другому судну из-за поломки рулевого оборудования",
            "C": "не может уступить дорогу другому судну из-за своей осадки",
            "D": "в бедствии и нуждается в немедленной помощи"
        }
    },
    141: {
        "question": "Внезапно вы слышите крик 'ЧЕЛОВЕК ЗА БОРТОМ С ЛЕВОГО БОРТА'. Каковы первые вещи, которые вы должны сделать?",
        "options": {
            "A": "вызвать Национальную береговую охрану по УКВ радио и сообщить о человеке за бортом",
            "B": "остановить двигатели и вызвать Национальную береговую охрану",
            "C": "остановить двигатели и бросить спасательный круг с левого борта",
            "D": "остановить двигатели и прыгнуть в воду для спасения"
        }
    },
    142: {
        "question": "Прямо перед вами вы замечаете медленно движущуюся лодку, которую вы обгоняете. Какой огонь вы увидите?",
        "options": {
            "A": "бортовой огонь правого борта",
            "B": "бортовой огонь левого борта",
            "C": "кормовой огонь",
            "D": "топовый огонь"
        }
    },
    143: {
        "question": "На завершающей стадии швартовки вы понимаете, что что-то пошло не так, и ваша лодка столкнулась с пирогой, пришвартованной неподалеку. Ваш первый приоритет -",
        "options": {
            "A": "отметить точную позицию столкновения согласно GPS",
            "B": "убедиться, что нет пострадавших или травм",
            "C": "убедиться, что пирога не повреждена",
            "D": "убедиться, что ваша лодка не повреждена"
        }
    },
    144: {
        "question": "Вы замечаете небольшое повреждение корпуса на правом борту, и все в порядке. Однако к тому времени, когда вы закончили швартовку, владелец пироги уже покинул причал. В такой ситуации вы",
        "options": {
            "A": "не обязаны сообщать об этом случае столкновения властям",
            "B": "должны сообщить об этом случае столкновения в НБО в течение 24 часов",
            "C": "должны сообщить об этом случае столкновения в НБО как можно скорее",
            "D": "не нужно сообщать об этом случае столкновения в НБО, если повреждение незначительное"
        }
    },
    145: {
        "question": "Это судно",
        "options": {
            "A": "ограничено в возможности маневрировать",
            "B": "стеснено своей осадкой",
            "C": "лишено возможности управляться",
            "D": "село на мель"
        }
    }
}

def apply_translations():
    """Apply correct Russian translations to questions 121-145"""
    
    with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
        quiz_data = json.load(f)
    
    count = 0
    for question in quiz_data:
        q_id = question['id']
        if q_id in translations:
            question['translations']['ru'] = translations[q_id]
            count += 1
    
    # Write atomically
    temp_fd, temp_path = tempfile.mkstemp(suffix='.json', text=True)
    try:
        with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
            json.dump(quiz_data, f, ensure_ascii=False, indent=2)
        os.replace(temp_path, 'quiz-data-final.json')
        print(f"✓ Fixed Russian translations for questions 121-145 ({count} questions)")
    except Exception as e:
        os.unlink(temp_path)
        raise e

if __name__ == "__main__":
    apply_translations()
