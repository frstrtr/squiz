#!/usr/bin/env python3
"""
Fix Russian option translations for questions 91-145 (final batch) based on actual English content
"""
import json
import os
import tempfile

options_translations = {
    91: {
        "A": "судно B пройдет впереди вашей лодки",
        "B": "ваша лодка пройдет впереди судна B",
        "C": "существует высокий риск столкновения",
        "D": "нет риска столкновения"
    },
    92: {
        "A": "снизить скорость и повернуть вправо",
        "B": "плыть с большой осторожностью",
        "C": "вызвать судно на канале 16, чтобы выяснить его намерения",
        "D": "решительно повернуть влево, чтобы держаться подальше от его маршрута"
    },
    93: {
        "A": "ограничено в возможности маневрировать",
        "B": "стеснено своей осадкой",
        "C": "лишено возможности управляться",
        "D": "село на мель"
    },
    94: {
        "A": "Компас",
        "B": "Руль",
        "C": "Винт",
        "D": "Радар"
    },
    95: {
        "A": "Белый огонь, видимый по всему горизонту на мачте",
        "B": "Красный огонь, видимый с носа до 22,5 градусов позади левого борта",
        "C": "Зеленый огонь, видимый с носа до 22,5 градусов позади правого борта",
        "D": "Белый огонь, видимый с кормы до 22,5 градусов позади каждого борта"
    },
    96: {
        "A": "055°",
        "B": "035°",
        "C": "045°",
        "D": "065°"
    },
    97: {
        "A": "Лодка A пройдет перед вашей лодкой",
        "B": "Лодка B пройдет перед вашей лодкой",
        "C": "Лодка A пройдет за вашей лодкой",
        "D": "Лодка B пройдет за вашей лодкой"
    },
    98: {
        "A": "Канал 06",
        "B": "Канал 16",
        "C": "Канал 67",
        "D": "Канал 69"
    },
    99: {
        "A": "11 и 78",
        "B": "14 и 78",
        "C": "18 и 74",
        "D": "12 и 72"
    },
    100: {
        "A": "Название лодки, характер бедствия, позиция и количество людей на борту",
        "B": "Название лодки, скорость и курс",
        "C": "Номер лицензии шкипера, регистрация лодки и номер мобильного телефона",
        "D": "Длина лодки, мощность двигателя и остаток топлива"
    },
    101: {
        "A": "Название лодки, характер бедствия, позиция и количество людей на борту",
        "B": "Название лодки, скорость и курс",
        "C": "Номер лицензии шкипера, регистрация лодки и номер мобильного телефона",
        "D": "Длина лодки, мощность двигателя и остаток топлива"
    },
    102: {
        "A": "плавучесть",
        "B": "остойчивость",
        "C": "водоизмещение",
        "D": "осадка"
    },
    103: {
        "A": "1 года",
        "B": "2 лет",
        "C": "3 лет",
        "D": "5 лет"
    },
    104: {
        "A": "ветер дует с правого борта",
        "B": "ветер дует с левого борта",
        "C": "ветер дует с кормы",
        "D": "ветер дует с носа"
    },
    105: {
        "A": "белый огонь или сигнальную ракету каждые 2 минуты",
        "B": "красный огонь каждые 5 минут",
        "C": "зеленый огонь каждую минуту",
        "D": "никаких сигналов"
    },
    106: {
        "A": "8 узлов",
        "B": "10 узлов",
        "C": "12 узлов",
        "D": "15 узлов"
    },
    107: {
        "A": "823 метра",
        "B": "823 десятых минуты",
        "C": "823 тысячных минуты",
        "D": "823 секунды"
    },
    108: {
        "A": "изменить курс влево",
        "B": "изменить курс вправо",
        "C": "увеличить скорость",
        "D": "уменьшить скорость"
    },
    109: {
        "A": "слева",
        "B": "справа",
        "C": "с любой стороны",
        "D": "не входить в канал"
    },
    110: {
        "A": "один раз",
        "B": "два раза",
        "C": "три раза",
        "D": "четыре раза"
    },
    111: {
        "A": "максимальная скорость судна",
        "B": "скорость, при которой можно предпринять надлежащие действия",
        "C": "5 узлов",
        "D": "половина максимальной скорости"
    },
    112: {
        "A": "судно, приближающееся с кормового сектора более 22,5 градусов",
        "B": "судно, приближающееся спереди",
        "C": "судно, пересекающее курс",
        "D": "судно на якоре"
    },
    113: {
        "A": "только белый круговой огонь",
        "B": "красный, зеленый и белый кормовой огонь",
        "C": "красный, зеленый, белый топовый и белый кормовой огонь",
        "D": "только красный и зеленый огни"
    },
    114: {
        "A": "черный конус вершиной вниз",
        "B": "черный шар",
        "C": "черный цилиндр",
        "D": "ничего"
    },
    115: {
        "A": "поддерживать курс и скорость",
        "B": "изменить курс вправо",
        "C": "изменить курс влево",
        "D": "остановиться"
    },
    116: {
        "A": "на пламя",
        "B": "на основание огня",
        "C": "над огнем",
        "D": "под огнем"
    },
    117: {
        "A": "12 узлов",
        "B": "15 узлов",
        "C": "18 узлов",
        "D": "20 узлов"
    },
    118: {
        "A": "в центре",
        "B": "слева и справа",
        "C": "только слева",
        "D": "только справа"
    },
    119: {
        "A": "оно касается дна и не может двигаться",
        "B": "оно на якоре",
        "C": "оно остановлено",
        "D": "у него отказал двигатель"
    },
    120: {
        "A": "это международный канал вызова и бедствия",
        "B": "его можно использовать для связи в военных зонах",
        "C": "после установления контакта следует перейти на рабочий канал",
        "D": "береговая охрана использует его для вызова судов"
    },
    121: {
        "A": "судно, ограниченное в возможности маневрировать",
        "B": "судно, стесненное своей осадкой",
        "C": "судно, лишенное возможности управляться",
        "D": "судно на мели"
    },
    122: {
        "A": "поддерживать курс, но увеличить скорость",
        "B": "поддерживать курс и скорость",
        "C": "изменить курс влево или вправо в зависимости от обстоятельств",
        "D": "остановить двигатель"
    },
    123: {
        "A": "Инспектор рыболовства",
        "B": "Уполномоченный сотрудник Управления по туризму только",
        "C": "Полицейский, офицер Национальной береговой охраны и уполномоченный сотрудник Управления по туризму",
        "D": "Только офицер Национальной береговой охраны"
    },
    124: {
        "A": "Когда прогулочное судно собирается покинуть лагуну",
        "B": "Когда видимость снижена",
        "C": "Когда, по их мнению, предполагаемый рейс является опасным",
        "D": "Когда прогулочное судно не оборудовано навигационными огнями"
    },
    125: {
        "A": "Канал 16",
        "B": "Канал 12",
        "C": "Канал 18",
        "D": "Канал 69"
    },
    126: {
        "A": "парусное судно",
        "B": "буксируемое судно",
        "C": "рыболовное судно",
        "D": "судно, лишенное возможности управляться"
    },
    127: {
        "A": "Что он обеспечит комфорт всех пассажиров",
        "B": "Что он поможет вам правильно оценить ситуацию, предупреждая о других судах",
        "C": "Что он проверит, что лодка движется в правильном направлении",
        "D": "Что он будет напоминать вам время по своим часам"
    },
    128: {
        "A": "парусное судно нуждается в помощи",
        "B": "парусное судно также использует двигатель для движения",
        "C": "парусное судно занято рыболовством",
        "D": "парусное судно оборудовано двигателем, но не использует его"
    },
    129: {
        "A": "изменить курс вправо и держаться на безопасном расстоянии",
        "B": "поддерживать курс и скорость",
        "C": "изменить курс влево и держаться на безопасном расстоянии",
        "D": "ждать, пока парусное судно маневрирует первым"
    },
    130: {
        "A": "5 узлов",
        "B": "2,5 узла",
        "C": "10 узлов",
        "D": "12,5 узлов"
    },
    131: {
        "A": "снизить скорость и изменить курс влево",
        "B": "снизить скорость, включить навигационные огни и продолжить движение с осторожностью",
        "C": "поддерживать курс и скорость",
        "D": "увеличить скорость, но поддерживать курс"
    },
    132: {
        "A": "срочно нуждается в помощи",
        "B": "занято водолазными работами",
        "C": "дрейфует",
        "D": "произошел несчастный случай с водолазом"
    },
    133: {
        "A": "снизить скорость и изменить курс, держась на расстоянии не менее 100 метров",
        "B": "снизить скорость и изменить курс, держась на расстоянии не менее 200 метров",
        "C": "снизить скорость и поддерживать курс",
        "D": "подойти к судну для оказания помощи"
    },
    134: {
        "A": "должны оставить этот буй по правому борту",
        "B": "должны оставить этот буй по левому борту",
        "C": "можете оставить этот буй как по левому, так и по правому борту",
        "D": "можете пройти очень близко к бую, потому что там достаточно воды"
    },
    135: {
        "A": "набор из двух знаков безопасной воды",
        "B": "боковые знаки",
        "C": "набор из двух специальных знаков",
        "D": "набор из двух красных знаков"
    },
    136: {
        "A": "канал 12 или 16",
        "B": "канал 61",
        "C": "канал 18",
        "D": "канал 69"
    },
    137: {
        "A": "снизить скорость и сделать большой поворот вправо",
        "B": "снизить скорость и сделать большой поворот влево",
        "C": "поддерживать курс и скорость",
        "D": "поддерживать курс и увеличить скорость, чтобы быстро пройти"
    },
    138: {
        "A": "танкер на мели",
        "B": "танкер на якоре",
        "C": "танкер не может маневрировать согласно правилам из-за своей осадки",
        "D": "танкер требует помощи"
    },
    139: {
        "A": "он приветствует туристов на вашей лодке",
        "B": "он нуждается в помощи",
        "C": "он указывает, что ваша лодка направляется к опасности",
        "D": "он указывает, что вы должны изменить курс"
    },
    140: {
        "A": "не может уступить дорогу другому судну из-за своей работы",
        "B": "не может уступить дорогу другому судну из-за поломки рулевого оборудования",
        "C": "не может уступить дорогу другому судну из-за своей осадки",
        "D": "в бедствии и нуждается в немедленной помощи"
    },
    141: {
        "A": "вызвать Национальную береговую охрану по УКВ радио и сообщить о человеке за бортом",
        "B": "остановить двигатели и вызвать Национальную береговую охрану",
        "C": "остановить двигатели и бросить спасательный круг с левого борта",
        "D": "остановить двигатели и прыгнуть в воду для спасения"
    },
    142: {
        "A": "бортовой огонь правого борта",
        "B": "бортовой огонь левого борта",
        "C": "кормовой огонь",
        "D": "топовый огонь"
    },
    143: {
        "A": "отметить точную позицию столкновения согласно GPS",
        "B": "убедиться, что нет пострадавших или травм",
        "C": "убедиться, что пирога не повреждена",
        "D": "убедиться, что ваша лодка не повреждена"
    },
    144: {
        "A": "не обязаны сообщать об этом случае столкновения властям",
        "B": "должны сообщить об этом случае столкновения в НБО в течение 24 часов",
        "C": "должны сообщить об этом случае столкновения в НБО как можно скорее",
        "D": "не нужно сообщать об этом случае столкновения в НБО, если повреждение незначительное"
    },
    145: {
        "A": "ограничено в возможности маневрировать",
        "B": "стеснено своей осадкой",
        "C": "лишено возможности управляться",
        "D": "село на мель"
    }
}

def apply_options_translations():
    """Apply correct Russian option translations to questions 91-145"""
    
    with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
        quiz_data = json.load(f)
    
    count = 0
    for question in quiz_data:
        q_id = question['id']
        if q_id in options_translations:
            question['translations']['ru']['options'] = options_translations[q_id]
            count += 1
    
    # Write atomically
    temp_fd, temp_path = tempfile.mkstemp(suffix='.json', text=True)
    try:
        with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
            json.dump(quiz_data, f, ensure_ascii=False, indent=2)
        os.replace(temp_path, 'quiz-data-final.json')
        print(f"✓ Fixed Russian option translations for questions 91-145 ({count} questions)")
    except Exception as e:
        os.unlink(temp_path)
        raise e

if __name__ == "__main__":
    apply_options_translations()
