#!/usr/bin/env python3
"""
Fix Russian option translations for questions 31-60 based on actual English content
"""
import json
import os
import tempfile

options_translations = {
    31: {
        "A": "столкнулось с проблемой двигателя",
        "B": "столкнулось с ситуацией, когда жизнь человека в опасности",
        "C": "собирается передать информацию об опасности для навигации",
        "D": "собирается передать позицию лайнера, который только что стал на якорь"
    },
    32: {
        "A": "занято ярусным ловом",
        "B": "вероятно, длиной более 50 метров, движется слева направо",
        "C": "вероятно, длиной более 50 метров и лишено возможности управляться",
        "D": "вероятно, длиной более 50 метров, движется справа налево"
    },
    33: {
        "A": "кислород, тепло и топливо",
        "B": "тепло, азот и топливо",
        "C": "тепло, влага и топливо",
        "D": "кислород, влага и азот"
    },
    34: {
        "A": "с левого борта",
        "B": "с правого борта",
        "C": "с наветренной стороны",
        "D": "с подветренной стороны"
    },
    35: {
        "A": "убедиться, что водяной насос работает",
        "B": "убедиться, что двигатель еще не включен на передний или задний ход",
        "C": "убедиться, что двигатель 4-тактного типа",
        "D": "убедиться, что на лодке никого больше нет"
    },
    36: {
        "A": "только шкипером",
        "B": "только владельцем судна",
        "C": "одним из пассажиров на борту судна",
        "D": "шкипером или владельцем судна"
    },
    37: {
        "A": "разрешение 14 лицам совершить морскую прогулку на прогулочном судне с регистрационным номером PC 2145 OL 12",
        "B": "управление прогулочным судном ночью в одиночку",
        "C": "непредоставление лицензии шкипера или ее копии по требованию уполномоченного офицера",
        "D": "управление прогулочным судном ночью без навигационных огней"
    },
    38: {
        "A": "когда он плывет в канале и в канале нет другого судна",
        "B": "когда существует опасная ситуация, которая делает необходимым маневрировать иначе для безопасности судна и людей на борту",
        "C": "когда ему нужно вовремя прибыть к месту назначения",
        "D": "когда плывет в районе с ограниченной видимостью"
    },
    39: {
        "A": "наблюдение только глазами",
        "B": "наблюдение за присутствием других судов только на радаре",
        "C": "поддержание слуховой вахты только на УКВ канале 16",
        "D": "использование всех доступных средств на борту судна для определения риска столкновения"
    },
    40: {
        "A": "5 градусов",
        "B": "60 градусов",
        "C": "90 градусов",
        "D": "30 градусов"
    },
    41: {
        "A": "Сильный дождь",
        "B": "Падение температуры",
        "C": "Увеличение скорости ветра",
        "D": "Падение атмосферного давления более чем на 3 мб после коррекции по высоте барометра над уровнем моря"
    },
    42: {
        "A": "Описание мест, которые пассажиры будут посещать во время поездки",
        "B": "Инструктаж по мерам безопасности и действиям в чрезвычайных ситуациях",
        "C": "Инструктаж об опыте шкипера в управлении судами в море",
        "D": "Описание профиля компании, на которую они работают"
    },
    43: {
        "A": "Вызвать все суда поблизости на УКВ канале 16 и запросить их позиции GPS",
        "B": "Снизить скорость",
        "C": "Проверить глубину воды с помощью эхолота",
        "D": "Прекратить визуальное наблюдение"
    },
    44: {
        "A": "использование УКВ радио на канале 16 без разрешения Управления порта Маврикия",
        "B": "использование звуковой сигнальной аппаратуры, такой как горн, без разрешения Управления порта Маврикия",
        "C": "пересечение канала из стороны в сторону таким образом, чтобы препятствовать проходу большого судна",
        "D": "отдача якоря в чрезвычайной ситуации"
    },
    45: {
        "A": "Показывая черный шар спереди и другой черный шар в корме судна",
        "B": "Показывая черный шар спереди только и белый огонь, видимый по всему горизонту, в корме судна",
        "C": "Показывая черный шар спереди, мигающий желтый огонь в корме и подавая один продолжительный звук с последующими 2 короткими с интервалами не более 2 минут",
        "D": "Показывая черный шар спереди и на корме 3 черных шара в вертикальной линии"
    },
    46: {
        "A": "Вызов Mayday на УКВ канале 16, нажать кнопку MOB на GPS, маневр лодки",
        "B": "Маневр лодки, нажать кнопку MOB на GPS, бросить спасательный круг к человеку",
        "C": "Бросить спасательный круг к человеку, выставить наблюдателя, маневр лодки",
        "D": "Бросить спасательный круг к человеку, вызов Mayday на УКВ канале 16, маневр лодки"
    },
    47: {
        "A": "Максимальное количество людей, которое можно перевозить на борту, составляет 12, включая шкипера",
        "B": "Судну не разрешено плавать за пределами 12 морских миль от берега",
        "C": "Судно лицензировано для коммерческой деятельности",
        "D": "Судно также может плавать в лагуне"
    },
    48: {
        "A": "вес лодки без средств движения",
        "B": "вертикальное расстояние между ватерлинией и килем лодки",
        "C": "вертикальное расстояние между ватерлинией и планширом лодки",
        "D": "расстояние между носом и кормой лодки"
    },
    49: {
        "A": "12 морских миль",
        "B": "6 морских миль",
        "C": "3 морских мили",
        "D": "9 морских миль"
    },
    50: {
        "A": "большое изменение курса влево",
        "B": "изменение курса на 10-15 градусов вправо",
        "C": "остановиться и включить двигатели на задний ход",
        "D": "поддерживать курс и скорость, потому что вы на привилегированном судне"
    },
    51: {
        "A": "желтого цвета и видимый по всему горизонту",
        "B": "желтого цвета и видимый под углом 135 градусов",
        "C": "белого цвета и видимый по всему горизонту",
        "D": "белого цвета и видимый под углом 135 градусов"
    },
    52: {
        "A": "описание мест, которые пассажиры смогут посетить",
        "B": "представление шкипером существующих мер безопасности и инструкций по безопасности, которые необходимо соблюдать во время рейса",
        "C": "представление шкипером своего опыта в области безопасности на море",
        "D": "представление компании, которая управляет лодкой"
    },
    53: {
        "A": "отдать оба конца, руль влево, правый двигатель вперед",
        "B": "отдать кормовой конец, руль на ноль, оба двигателя назад",
        "C": "отдать кормовой конец, руль вправо, левый двигатель вперед",
        "D": "отдать оба конца, руль влево, оба двигателя вперед"
    },
    54: {
        "A": "30 градусов",
        "B": "60 градусов",
        "C": "90 градусов",
        "D": "5 градусов"
    },
    55: {
        "A": "Плавучесть",
        "B": "Остойчивость",
        "C": "Водоизмещение",
        "D": "Баланс"
    },
    56: {
        "A": "Обеспечить, чтобы лодка была чистой и хорошо обслуживаемой",
        "B": "Обеспечить безопасность всех лиц на борту",
        "C": "Прибыть к месту назначения вовремя",
        "D": "Регулярно общаться с береговой охраной"
    },
    57: {
        "A": "Красный и белый",
        "B": "Красный и зеленый",
        "C": "Желтый и черный",
        "D": "Синий и белый"
    },
    58: {
        "A": "обозначить центральную линию судоходного канала",
        "B": "обозначить стороны судоходного канала",
        "C": "обозначить зоны опасности",
        "D": "обозначить якорные стоянки"
    },
    59: {
        "A": "проверка того, что единственный рабочий двигатель мощностью 40 л.с. находится в отличном рабочем состоянии",
        "B": "дача четких инструкций шкиперу, чтобы на судно не взошло более 14 человек, включая его самого",
        "C": "передача шкиперу времени высокой и низкой воды",
        "D": "совет шкиперу никогда не изменять курс влево ни в какой ситуации в море"
    },
    60: {
        "A": "непредоставление отчета о происшествии, в котором его прогулочное судно получило повреждение, в течение 24 часов директору Управления по туризму",
        "B": "непредоставление имени и адреса владельца прогулочного судна по требованию уполномоченного офицера",
        "C": "управление прогулочным судном в частных целях в возрасте всего 16 лет",
        "D": "управление прогулочным судном со скоростью 12 узлов в канале Гранд-Ривер Саут-Ист"
    }
}

def apply_options_translations():
    """Apply correct Russian option translations to questions 31-60"""
    
    with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
        quiz_data = json.load(f)
    
    count = 0
    for question in quiz_data:
        q_id = question['id']
        if q_id in options_translations:
            question['translations']['ru']['options'] = options_translations[q_id]
            count += 1
    
    # Write atomically
    temp_fd, temp_path = tempfile.mkstemp(suffix='.json', text=True)
    try:
        with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
            json.dump(quiz_data, f, ensure_ascii=False, indent=2)
        os.replace(temp_path, 'quiz-data-final.json')
        print(f"✓ Fixed Russian option translations for questions 31-60 ({count} questions)")
    except Exception as e:
        os.unlink(temp_path)
        raise e

if __name__ == "__main__":
    apply_options_translations()
