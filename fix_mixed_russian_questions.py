import json
import os
import tempfile

# Read the data
with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
    data = json.load(f)

# Questions that need Russian question text fixed
fixes = {
    11: {
        "question": "Вы управляете прогулочным судном на скорости 17 узлов в открытом море, когда внезапно видимость резко ухудшается. Вы снижаете скорость до 6 узлов. Какое следующее действие вы предпримете в порядке приоритета?"
    },
    12: {
        "question": "Вы видите этот огонь примерно в 1 морской миле слева по носу, когда идете курсом 050 C. Как компетентный шкипер, вы должны"
    },
    13: {
        "question": "Какое утверждение ВЕРНО относительно этого судна?"
    },
    14: {
        "question": "Вы приближаетесь к повороту в гавани, и из-за зданий вы не можете видеть, есть ли движение на другой стороне. Поэтому вы должны"
    },
    16: {
        "question": "Какое утверждение относительно областей НИЗКОГО ДАВЛЕНИЯ НЕВЕРНО?"
    },
    17: {
        "question": "Вы шкипер на борту прогулочного судна 'A', идущего курсом 120°C на скорости 18 узлов. Судно 'B' находится прямо впереди вас на расстоянии одной морской мили. Его пеленг (120°C) не изменился за последние десять минут. Какой маневр вы должны выполнить, если считаете, что вы являетесь судном, обязанным уступить дорогу?"
    },
    22: {
        "question": "В этой ситуации, согласно Международным правилам предупреждения столкновений судов в море, вы должны"
    },
    23: {
        "question": "Шкипер всегда должен маневрировать своей лодкой так, чтобы он мог поднять человека за бортом с"
    },
    25: {
        "question": "Какое из следующих утверждений НЕВЕРНО относительно УКВ канала 16?"
    },
    26: {
        "question": "Чтобы вызвать Управление портов Маврикия по УКВ, вы должны выбрать"
    },
    27: {
        "question": "Эти знаки указывают, что"
    },
    28: {
        "question": "Вы шкипер лодки, идущей со скоростью 20 узлов в открытом море, когда сильный дождь внезапно снижает видимость. Вы должны сначала"
    },
    29: {
        "question": "Движение воздуха из области высокого давления в область низкого давления более известно как"
    }
}

# Apply fixes
for qid, fix_data in fixes.items():
    for q in data:
        if q['id'] == qid:
            q['translations']['ru']['question'] = fix_data['question']
            print(f"✓ Fixed Q{qid}")
            break

# Write atomically
with tempfile.NamedTemporaryFile('w', encoding='utf-8', delete=False, dir='.') as tmp:
    json.dump(data, tmp, ensure_ascii=False, indent=2)
    tmp_name = tmp.name

os.replace(tmp_name, 'quiz-data-final.json')

print(f"\n✓ Fixed {len(fixes)} Russian question translations")
print("✓ File updated successfully")
