#!/usr/bin/env python3
"""
Add complete Russian translations for questions 91-120
Maritime/nautical terminology for Mauritius skipper exam
"""
import json
import os
import tempfile

# Russian translations for questions 91-120
translations = {
    91: {
        "question": "Шкипер должен сообщить о столкновении в Управление по туризму в течение",
        "options": {
            "A": "6 часов",
            "B": "12 часов",
            "C": "24 часов",
            "D": "48 часов"
        }
    },
    92: {
        "question": "Максимальная вместимость прогулочного судна определяется",
        "options": {
            "A": "шкипером",
            "B": "пассажирами",
            "C": "производителем судна",
            "D": "погодными условиями"
        }
    },
    93: {
        "question": "Это судно",
        "options": {
            "A": "занято рыболовством",
            "B": "ограничено в маневренности",
            "C": "лишено возможности управляться",
            "D": "парусное судно"
        }
    },
    94: {
        "question": "Это судно",
        "options": {
            "A": "судно с механическим двигателем на ходу",
            "B": "парусное судно на ходу",
            "C": "судно на якоре",
            "D": "судно, занятое буксировкой"
        }
    },
    95: {
        "question": "Это судно",
        "options": {
            "A": "парусное судно на ходу",
            "B": "судно с механическим двигателем на ходу",
            "C": "судно на якоре",
            "D": "судно, лишенное возможности управляться"
        }
    },
    96: {
        "question": "Какое из следующих утверждений ВЕРНО относительно буксировки воднолыжника?",
        "options": {
            "A": "можно буксировать в любое время дня",
            "B": "нельзя буксировать между закатом и восходом солнца",
            "C": "можно буксировать в главном канале",
            "D": "наблюдатель не нужен"
        }
    },
    97: {
        "question": "Это судно",
        "options": {
            "A": "на якоре",
            "B": "на мели",
            "C": "занято рыболовством",
            "D": "ограничено в маневренности"
        }
    },
    98: {
        "question": "Какое из следующих действий НЕ является обязанностью шкипера?",
        "options": {
            "A": "обеспечить безопасность всех на борту",
            "B": "обеспечить наличие достаточного количества топлива",
            "C": "обеспечить наличие надлежащего оборудования безопасности",
            "D": "позволить пассажирам управлять судном без надзора"
        }
    },
    99: {
        "question": "Рация VHF должна",
        "options": {
            "A": "всегда быть включенной на канал 16",
            "B": "использоваться только в экстренных случаях",
            "C": "быть выключенной в гавани",
            "D": "использоваться только для социальных разговоров"
        }
    },
    100: {
        "question": "Узел - это единица измерения",
        "options": {
            "A": "расстояния",
            "B": "скорости",
            "C": "глубины",
            "D": "веса"
        }
    },
    101: {
        "question": "Морская миля равна примерно",
        "options": {
            "A": "1 километр",
            "B": "1,5 километра",
            "C": "1,852 километра",
            "D": "2 километра"
        }
    },
    102: {
        "question": "Какое из следующих утверждений НЕВЕРНО относительно подачи топлива?",
        "options": {
            "A": "выключите двигатель",
            "B": "запретите курить",
            "C": "держите огнетушитель под рукой",
            "D": "оставьте двигатель работающим для вентиляции"
        }
    },
    103: {
        "question": "При буксировке воднолыжника флаг наблюдателя должен быть",
        "options": {
            "A": "красным",
            "B": "оранжевым",
            "C": "желтым",
            "D": "зеленым"
        }
    },
    104: {
        "question": "Килевая качка - это",
        "options": {
            "A": "движение судна вверх и вниз",
            "B": "движение судна из стороны в сторону",
            "C": "вращение судна",
            "D": "движение судна вперед"
        }
    },
    105: {
        "question": "Бортовая качка - это",
        "options": {
            "A": "движение судна вверх и вниз",
            "B": "движение судна из стороны в сторону",
            "C": "вращение судна",
            "D": "движение судна назад"
        }
    },
    106: {
        "question": "Рыскание - это",
        "options": {
            "A": "движение судна вверх и вниз",
            "B": "движение судна из стороны в сторону",
            "C": "вращение судна вокруг вертикальной оси",
            "D": "движение судна по кругу"
        }
    },
    107: {
        "question": "Какое из следующих утверждений ВЕРНО относительно алкоголя и управления судном?",
        "options": {
            "A": "можно употреблять алкоголь во время управления судном",
            "B": "употребление алкоголя во время управления судном является правонарушением",
            "C": "можно употреблять алкоголь, если вы опытный шкипер",
            "D": "алкоголь улучшает способность управлять судном"
        }
    },
    108: {
        "question": "Минимальный возраст для управления гидроциклом составляет",
        "options": {
            "A": "14 лет",
            "B": "16 лет",
            "C": "18 лет",
            "D": "21 год"
        }
    },
    109: {
        "question": "При швартовке к причалу следует",
        "options": {
            "A": "подходить на полной скорости",
            "B": "подходить медленно под углом",
            "C": "подходить быстро прямо",
            "D": "использовать задний ход на полной скорости"
        }
    },
    110: {
        "question": "Фендеры используются для",
        "options": {
            "A": "защиты судна от повреждений при швартовке",
            "B": "увеличения скорости судна",
            "C": "улучшения устойчивости",
            "D": "украшения судна"
        }
    },
    111: {
        "question": "Какое из следующих утверждений НЕВЕРНО относительно погодных условий?",
        "options": {
            "A": "всегда проверяйте прогноз погоды перед выходом",
            "B": "вернитесь в порт, если погода ухудшается",
            "C": "можно игнорировать небольшие штормовые предупреждения",
            "D": "имейте план действий в плохую погоду"
        }
    },
    112: {
        "question": "Это флаг",
        "options": {
            "A": "флаг А - у меня есть водолаз",
            "B": "флаг В - я загружаю опасный груз",
            "C": "флаг Q - я прошу свободную практику",
            "D": "флаг О - человек за бортом"
        }
    },
    113: {
        "question": "Это флаг",
        "options": {
            "A": "флаг А - у меня есть водолаз",
            "B": "флаг В - я загружаю опасный груз",
            "C": "флаг Q - я прошу свободную практику",
            "D": "флаг О - человек за бортом"
        }
    },
    114: {
        "question": "Трюмный насос используется для",
        "options": {
            "A": "откачки воды из судна",
            "B": "подачи топлива",
            "C": "охлаждения двигателя",
            "D": "мытья палубы"
        }
    },
    115: {
        "question": "Какое из следующих утверждений ВЕРНО относительно спасательных плотов?",
        "options": {
            "A": "они не нужны на малых судах",
            "B": "они должны регулярно обслуживаться",
            "C": "их можно хранить где угодно на судне",
            "D": "они нужны только на коммерческих судах"
        }
    },
    116: {
        "question": "Винт - это",
        "options": {
            "A": "рулевое устройство",
            "B": "якорное устройство",
            "C": "движитель с лопастями",
            "D": "навигационное устройство"
        }
    },
    117: {
        "question": "Какое из следующих действий следует предпринять перед запуском двигателя?",
        "options": {
            "A": "проверить, нет ли людей в воде вокруг судна",
            "B": "включить радио",
            "C": "поднять якорь",
            "D": "открыть все люки"
        }
    },
    118: {
        "question": "Трим судна - это",
        "options": {
            "A": "ширина судна",
            "B": "разница в осадке между носом и кормой",
            "C": "общий вес судна",
            "D": "скорость судна"
        }
    },
    119: {
        "question": "Какое из следующих утверждений ВЕРНО относительно детей на борту?",
        "options": {
            "A": "они должны всегда носить спасательные жилеты",
            "B": "они могут свободно перемещаться по судну",
            "C": "им не нужны спасательные жилеты в спокойную погоду",
            "D": "они могут сидеть на поручнях"
        }
    },
    120: {
        "question": "Какое из следующих утверждений НЕВЕРНО относительно использования VHF радио?",
        "options": {
            "A": "канал 16 является каналом бедствия и вызова",
            "B": "можно использовать канал 16 для связи в военных зонах",
            "C": "после установления контакта следует перейти на рабочий канал",
            "D": "следует говорить четко и медленно"
        }
    }
}

def apply_translations():
    """Apply Russian translations to questions 91-120"""
    
    with open('quiz-data-final.json', 'r', encoding='utf-8') as f:
        quiz_data = json.load(f)
    
    count = 0
    for question in quiz_data:
        q_id = question['id']
        if q_id in translations:
            question['translations']['ru'] = translations[q_id]
            count += 1
    
    # Write atomically
    temp_fd, temp_path = tempfile.mkstemp(suffix='.json', text=True)
    try:
        with os.fdopen(temp_fd, 'w', encoding='utf-8') as f:
            json.dump(quiz_data, f, ensure_ascii=False, indent=2)
        os.replace(temp_path, 'quiz-data-final.json')
        print(f"✓ Translated questions 91-120 ({count} questions)")
    except Exception as e:
        os.unlink(temp_path)
        raise e

if __name__ == "__main__":
    apply_translations()
